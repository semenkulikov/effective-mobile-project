-- Блок 3: SQL
-- Задание 1: Абитуриенты
-- 
-- Есть таблица examination с двумя полями:
--   id (id абитуриента)
--   scores (кол-во набранных баллов дополнительного вступительного испытания от 0 до 100)
--
-- Требуется реализовать запрос, который создаёт колонку с позицией абитуриента в общем рейтинге.

-- Решение: Используем оконную функцию RANK() или ROW_NUMBER()
-- RANK() - если есть одинаковые баллы, они получают одинаковый ранг, следующий ранг пропускается
-- DENSE_RANK() - если есть одинаковые баллы, они получают одинаковый ранг, следующий ранг не пропускается
-- ROW_NUMBER() - каждому абитуриенту присваивается уникальный номер, даже при одинаковых баллах

-- Вариант 1: Использование RANK() (рекомендуемый для рейтинга)
SELECT 
    id,
    scores,
    RANK() OVER (ORDER BY scores DESC) AS position
FROM examination;

-- Вариант 2: Использование DENSE_RANK() (если нужно без пропусков в рангах)
SELECT 
    id,
    scores,
    DENSE_RANK() OVER (ORDER BY scores DESC) AS position
FROM examination;

-- Вариант 3: Использование ROW_NUMBER() (если нужна уникальная позиция для каждого)
-- При одинаковых баллах порядок будет произвольным, можно добавить id для детерминированности
SELECT 
    id,
    scores,
    ROW_NUMBER() OVER (ORDER BY scores DESC, id ASC) AS position
FROM examination;

-- Примечание: ORDER BY scores DESC означает, что больший балл = лучшая позиция (1-е место)
